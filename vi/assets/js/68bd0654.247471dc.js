"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3147],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var a=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=a.createContext({}),c=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(t),m=i,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||r;return t?a.createElement(h,o(o({ref:n},p),{},{components:t})):a.createElement(h,o({ref:n},p))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},87193:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>c,toc:()=>u});var a=t(87462),i=t(63366),r=(t(67294),t(3905)),o=["components"],s={id:"index",title:"near-sdk-js",sidebar_label:"Readme",sidebar_position:0,custom_edit_url:null},l=void 0,c={unversionedId:"index",id:"version-near-sdk-js@0.7.0/index",title:"near-sdk-js",description:"Warning",source:"@site/near-sdk-js_versioned_docs/version-near-sdk-js@0.7.0/index.md",sourceDirName:".",slug:"/",permalink:"/near_docs/vi/sdk/near-sdk-js/reference/",draft:!1,editUrl:null,tags:[],version:"near-sdk-js@0.7.0",sidebarPosition:0,frontMatter:{id:"index",title:"near-sdk-js",sidebar_label:"Readme",sidebar_position:0,custom_edit_url:null},sidebar:"defaultSidebar",next:{title:"Modules",permalink:"/near_docs/vi/sdk/near-sdk-js/reference/modules"}},p={},u=[{value:"Quick Start",id:"quick-start",level:2},{value:"Running Examples",id:"running-examples",level:2},{value:"Test",id:"test",level:2},{value:"Error Handling in NEAR-SDK-JS",id:"error-handling-in-near-sdk-js",level:2},{value:"Migrating from near-sdk-js 0.6.0",id:"migrating-from-near-sdk-js-060",level:2},{value:"NEAR-SDK-JS API Reference",id:"near-sdk-js-api-reference",level:2},{value:"About Type",id:"about-type",level:3},{value:"Context API",id:"context-api",level:3},{value:"Economics API",id:"economics-api",level:3},{value:"Math API",id:"math-api",level:3},{value:"Miscellaneous API",id:"miscellaneous-api",level:3},{value:"Promises API",id:"promises-api",level:3},{value:"Promise API actions",id:"promise-api-actions",level:3},{value:"Promise API results",id:"promise-api-results",level:3},{value:"Storage API",id:"storage-api",level:3},{value:"Validator API",id:"validator-api",level:3},{value:"Alt BN128",id:"alt-bn128",level:3},{value:"NearBindgen and other decorators",id:"nearbindgen-and-other-decorators",level:3},{value:"Collections",id:"collections",level:3},{value:"Vector",id:"vector",level:4},{value:"LookupMap",id:"lookupmap",level:4},{value:"LookupSet",id:"lookupset",level:4},{value:"UnorderedMap",id:"unorderedmap",level:4},{value:"UnorderedSet",id:"unorderedset",level:4},{value:"Highlevel Promise APIs",id:"highlevel-promise-apis",level:3},{value:"Types",id:"types",level:3},{value:"Public Key",id:"public-key",level:4},{value:"How to use NEAR SDK JS on Windows",id:"how-to-use-near-sdk-js-on-windows",level:2}],d={toc:u};function m(e){var n=e.components,t=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Warning")),(0,r.kt)("p",{parentName:"blockquote"},"This SDK is currently in ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://github.com/near/near-sdk-js/releases/"},(0,r.kt)("inlineCode",{parentName:"a"},"Alpha"))),"."),(0,r.kt)("p",{parentName:"blockquote"},"The JavaScript runtime has not been fully audited. For creating smart contracts that hold value please use ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/near/near-sdk-rs"},(0,r.kt)("inlineCode",{parentName:"a"},"near-sdk-rs")),"."),(0,r.kt)("p",{parentName:"blockquote"},"Help contribute!"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/issues"},"Report issues you encounter")," \ud83d\udc1e"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/discussions"},"Provide suggestions or feedback")," \ud83d\udca1"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/discussions/categories/show-and-tell"},"Show us what you've built!")," \ud83d\udcaa"))),(0,r.kt)("h1",{id:"near-javascript-sdk"},"NEAR JavaScript SDK"),(0,r.kt)("h2",{id:"quick-start"},"Quick Start"),(0,r.kt)("p",null,"Use ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/near/create-near-app"},(0,r.kt)("inlineCode",{parentName:"a"},"create-near-app"))," to quickly get started writing smart contracts in JavaScript on NEAR."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npx create-near-app\n")),(0,r.kt)("p",null,"This will scaffold a basic template for you \ud83d\ude0e"),(0,r.kt)("p",null,"Learn more in our ",(0,r.kt)("a",{parentName:"p",href:"https://docs.near.org/develop/quickstart-guide"},"Quick Start guide"),"."),(0,r.kt)("h2",{id:"running-examples"},"Running Examples"),(0,r.kt)("p",null,"There are a couple of contract examples in the project:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/clean-state.js"},"Clean contract state")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/counter-lowlevel.js"},"Counter using low level API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/counter.js"},"Counter in JavaScript")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/counter.ts"},"Counter in TypeScript")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/cross-contract-call.js"},"Doing cross contract call")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/fungible-token.js"},"Fungible token")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/fungible-token-lockable.js"},"Lockable fungible token")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/non-fungible-token.js"},"Non fungible token")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/non-fungible-token-receiver.js"},"Non fungible token receiver contract")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/status-message.js"},"Status message board")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/status-message-collections.js"},"Status message board with unique messages")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/near/near-sdk-js/tree/develop/examples/src/programmatic-update.js"},"Programmatic Update After Locking The Contract"))),(0,r.kt)("p",null,"To build all examples, run ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm build")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"examples/"),". To test all examples, run ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm test"),". You can also build and test one specific example with ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm build:<example-name>")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm test:<example-name>"),", see ",(0,r.kt)("inlineCode",{parentName:"p"},"examples/package.json"),"."),(0,r.kt)("p",null,"To deploy and call a contract on a NEAR node, use near-cli's ",(0,r.kt)("inlineCode",{parentName:"p"},"near deploy")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"near call"),"."),(0,r.kt)("h2",{id:"test"},"Test"),(0,r.kt)("p",null,"We recommend to use near-workspaces to write tests for your smart contracts. See any of the examples for how tests are setup and written."),(0,r.kt)("h2",{id:"error-handling-in-near-sdk-js"},"Error Handling in NEAR-SDK-JS"),(0,r.kt)("p",null,"If you want to indicate an error happened and fail the transaction, just throw an error object in JavaScript. The compiled JavaScript contract includes error handling capability. It will catch throwed errors and automatically invoke ",(0,r.kt)("inlineCode",{parentName:"p"},"panic_utf8")," with ",(0,r.kt)("inlineCode",{parentName:"p"},'"{error.message}\\n:{error.stack}"'),". As a result, transaction will fail with ",(0,r.kt)("inlineCode",{parentName:"p"},'"Smart contract panicked: {error.message}\\n{error.stack}"')," error message. You can also use an error utilities library to organize your errors, such as verror."),(0,r.kt)("p",null,"When your JS code or library throws an error, uncaught, the transaction will also fail with GuestPanic error, with the error message and stacktrace."),(0,r.kt)("p",null,"When call host function with inappropriate type, means incorrect number of arguments or arg is not expected type:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"if arguments less than params, remaining argument are set as 'undefined'"),(0,r.kt)("li",{parentName:"ul"},"if arguments more than params, remaining argument are ignored"),(0,r.kt)("li",{parentName:"ul"},"if argument is different than the required type, it'll be coerced to required type"),(0,r.kt)("li",{parentName:"ul"},"if argument is different than the required type but cannot be coerced, will throw runtime type error, also with message and stacktrace")),(0,r.kt)("h2",{id:"migrating-from-near-sdk-js-060"},"Migrating from near-sdk-js 0.6.0"),(0,r.kt)("p",null,"If you have a near-sdk-js 0.6.0 contract, you need to drop the ",(0,r.kt)("inlineCode",{parentName:"p"},"babel.config.json")," because it is now inlined in near-sdk-js CLI."),(0,r.kt)("p",null,"Also ",(0,r.kt)("inlineCode",{parentName:"p"},"Bytes")," type in 0.6.0 is replaced with ",(0,r.kt)("inlineCode",{parentName:"p"},"string")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8Array"),". Because ",(0,r.kt)("inlineCode",{parentName:"p"},"Bytes")," was an alias to ",(0,r.kt)("inlineCode",{parentName:"p"},"string"),", this doesn't affect all collection APIs and most low level APIs. Some low level APIs below now also comes with a raw version, which ends with ",(0,r.kt)("inlineCode",{parentName:"p"},"Raw")," and takes ",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8Array")," instead of ",(0,r.kt)("inlineCode",{parentName:"p"},"string"),", for example, ",(0,r.kt)("inlineCode",{parentName:"p"},"storageRead")," vs ",(0,r.kt)("inlineCode",{parentName:"p"},"storageReadRaw"),". Some low level APIs have more sense to use ",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8Array")," instead of ",(0,r.kt)("inlineCode",{parentName:"p"},"string"),", such as ",(0,r.kt)("inlineCode",{parentName:"p"},"sha256")," and arguments for a function call type of promise, these are ",(0,r.kt)("strong",{parentName:"p"},"BREAKING")," changes. Please refer to next section for details: look for functions with ",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8Array")," argument and return types."),(0,r.kt)("h2",{id:"near-sdk-js-api-reference"},"NEAR-SDK-JS API Reference"),(0,r.kt)("p",null,"All NEAR blockchain provided functionality (host functions) are defined in ",(0,r.kt)("inlineCode",{parentName:"p"},"src/api.ts")," and exported as ",(0,r.kt)("inlineCode",{parentName:"p"},"near"),". You can use them by:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'import { near } from "near-sdk-js";\n\n// near.<api doucmented below>. e.g.:\nlet signer = near.signerAccountId();\n')),(0,r.kt)("p",null,"To use nightly host functions, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"altBn128G1Sum"),", your contract need to be built with nightly enabled. Use:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"export NEAR_NIGHTLY=1\npnpm build\n")),(0,r.kt)("h3",{id:"about-type"},"About Type"),(0,r.kt)("p",null,"NEAR-SDK-JS is written in TypeScript, so every API function has a type specified by signature that looks familiar to JavaScript/TypeScript Developers. Two types in the signature need a special attention:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Most of the API take ",(0,r.kt)("inlineCode",{parentName:"li"},"bigint")," instead of Number as type. This because JavaScript Number cannot hold 64 bit and 128 bit integer without losing precision."),(0,r.kt)("li",{parentName:"ul"},"For those API that takes or returns raw bytes, it is a JavaScript ",(0,r.kt)("inlineCode",{parentName:"li"},"Uint8Array"),". You can use standard ",(0,r.kt)("inlineCode",{parentName:"li"},"Uint8Array")," methods on it or decode it to string with ",(0,r.kt)("inlineCode",{parentName:"li"},"decode")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"str"),". The differece between ",(0,r.kt)("inlineCode",{parentName:"li"},"decode")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"str")," is: ",(0,r.kt)("inlineCode",{parentName:"li"},"decode")," decode the array as UTF-8 sequence. ",(0,r.kt)("inlineCode",{parentName:"li"},"str")," simply converts each Uint8 to one char with that char code.")),(0,r.kt)("h3",{id:"context-api"},"Context API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function currentAccountId(): string;\nfunction signerAccountId(): string;\nfunction signerAccountPk(): Uint8Array;\nfunction predecessorAccountId(): string;\nfunction inputRaw(): Uint8Array;\nfunction input(): string;\nfunction blockIndex(): bigint;\nfunction blockHeight(): bigint;\nfunction blockTimestamp(): bigint;\nfunction epochHeight(): bigint;\nfunction storageUsage(): bigint\n")),(0,r.kt)("h3",{id:"economics-api"},"Economics API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function accountBalance(): bigint;\nfunction accountLockedBalance(): bigint;\nfunction attachedDeposit(): bigint;\nfunction prepaidGas(): bigint;\nfunction usedGas(): bigint;\n")),(0,r.kt)("h3",{id:"math-api"},"Math API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function randomSeed(): Uint8Array;\nfunction sha256(value: Uint8Array): Uint8Array;\nfunction keccak256(value: Uint8Array): Uint8Array;\nfunction keccak512(value: Uint8Array): Uint8Array;\nfunction ripemd160(value: Uint8Array): Uint8Array;\nfunction ecrecover(hash: Uint8Array, sign: Uint8Array, v: bigint, malleability_flag: bigint): Uint8Array | null;\n")),(0,r.kt)("h3",{id:"miscellaneous-api"},"Miscellaneous API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function valueReturnRaw(value: Uint8Array);\nfunction valueReturn(value: string);\nfunction panic(msg?: string);\nfunction panicUtf8(msg: Uint8Array);\nfunction logUtf8(msg: Uint8Array);\nfunction logUtf16(msg: Uint8Array);\nfunction log(...params: unknown[]);\n\n")),(0,r.kt)("h3",{id:"promises-api"},"Promises API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function promiseCreate(account_id: string, method_name: string, arguments: Uint8Array, amount: bigint, gas: bigint): bigint;\nfunction promiseThen(promise_index: bigint, account_id: string, method_name: string, arguments: Uint8Array, amount: bigint, gas: bigint): bigint;\nfunction promiseAnd(...promise_idx: bigint): bigint;\nfunction promiseBatchCreate(account_id: string): bigint;\nfunction promiseBatchThen(promise_index: bigint, account_id: string): bigint;\n")),(0,r.kt)("h3",{id:"promise-api-actions"},"Promise API actions"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function promiseBatchActionCreateAccount(promise_index: PromiseIndex);\nfunction promiseBatchActionDeployContract(promise_index: PromiseIndex, code: Uint8Array);\nfunction promiseBatchActionFunctionCall(promise_index: PromiseIndex, method_name: string, arguments: Uint8Array, amount: bigint, gas: bigint);\nfunction promiseBatchActionFunctionCallWeight(promise_index: PromiseIndex, method_name: string, arguments: Uint8Array, amount: bigint, gas: bigint, weight: bigint);\nfunction promiseBatchActionTransfer(promise_index: PromiseIndex, amount: bigint);\nfunction promiseBatchActionStake(promise_index: PromiseIndex, amount: bigint, public_key: Uint8Array);\nfunction promiseBatchActionAddKeyWithFullAccess(promise_index: PromiseIndex, public_key: Uint8Array, nonce: bigint);\nfunction promiseBatchActionAddKeyWithFunctionCall(promise_index: PromiseIndex, public_key: Uint8Array, nonce: bigint, allowance: bigint, receiver_id: string, method_names: string);\nfunction promiseBatchActionDeleteKey(promise_index: PromiseIndex, public_key: Uint8Array);\nfunction promiseBatchActionDeleteAccount(promise_index: PromiseIndex, beneficiary_id: string);\n")),(0,r.kt)("h3",{id:"promise-api-results"},"Promise API results"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function promiseResultsCount(): bigint;\nfunction promiseResultRaw(result_idx: PromiseIndex): Uint8Array;\nfunction promiseResult(result_idx: PromiseIndex): string;\nfunction promiseReturn(promise_idx: PromiseIndex);\n")),(0,r.kt)("h3",{id:"storage-api"},"Storage API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function storageWriteRaw(key: Uint8Array, value: Uint8Array): boolean;\nfunction storageReadRaw(key: Uint8Array): Uint8Array | null;\nfunction storageRemoveRaw(key: Uint8Array): boolean;\nfunction storageHasKeyRaw(key: Uint8Array): boolean;\nfunction storageWrite(key: string, value: string): boolean;\nfunction storageRead(key: string): bigint;\nfunction storageRemove(key: string): bigint;\nfunction storageHasKey(key: string): bigint;\n")),(0,r.kt)("h3",{id:"validator-api"},"Validator API"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function validatorStake(account_id: string): bigint;\nfunction validatorTotalStake(): bigint;\n")),(0,r.kt)("h3",{id:"alt-bn128"},"Alt BN128"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"function altBn128G1Multiexp(value: Uint8Array): Uint8Array;\nfunction altBn128G1Sum(value: Uint8Array): Uint8Array;\nfunction altBn128PairingCheck(value: Uint8Array): boolean;\n")),(0,r.kt)("h3",{id:"nearbindgen-and-other-decorators"},"NearBindgen and other decorators"),(0,r.kt)("p",null,"You can write a simple smart contract by only using low-level APIs, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"near.input()"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"near.storageRead()"),", etc. In this case, the API of your contract will consist of all the exported JS functions. You can find an example of such a contract ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/near/near-sdk-js/blob/develop/examples/src/counter-lowlevel.js"},"here"),"."),(0,r.kt)("p",null,"But if you want to build a more complex contracts with ease, you can use decorators from this SDK that will handle serialization, deserialization, and other boilerplate operations for you."),(0,r.kt)("p",null,"In order to do that, your contract must be a class decorated with ",(0,r.kt)("inlineCode",{parentName:"p"},"@NearBindgen({})"),". Each method in this class with ",(0,r.kt)("inlineCode",{parentName:"p"},"@call({})"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"@view({})"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"@initialize({})")," decorators will become functions of your smart contract. ",(0,r.kt)("inlineCode",{parentName:"p"},"call")," functions can change state, and ",(0,r.kt)("inlineCode",{parentName:"p"},"view")," functions can only read it."),(0,r.kt)("p",null,"Your class must have a ",(0,r.kt)("inlineCode",{parentName:"p"},"constructor()"),". You will not be able to call it, which is why it should not accept any parameters. You must declare all the parameters that you are planning to use in the constructor and set default values."),(0,r.kt)("p",null,"The simplest example of the contract that follows all these rules can be found ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/near/near-sdk-js/blob/develop/examples/src/status-message.js"},"here")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"NearBindgen")," decorator can accept ",(0,r.kt)("inlineCode",{parentName:"p"},"requireInit parameter"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-JS"},"@NearBindgen({ requireInit: true })\nclass YourContract {\n    ...\n}\n")),(0,r.kt)("p",null,"It is ",(0,r.kt)("inlineCode",{parentName:"p"},"false")," by default, but if you will set it to ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),", it will prevent all the ",(0,r.kt)("inlineCode",{parentName:"p"},"call")," functions from being executed before you initialize the state of the contract."),(0,r.kt)("p",null,"In order to initialize the contract, you need to add functions flagged with ",(0,r.kt)("inlineCode",{parentName:"p"},"@initialize({})")," decorator."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"@call({})")," decorator can accept two parameters: ",(0,r.kt)("inlineCode",{parentName:"p"},"privateFunction")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"payableFunction"),". They are both ",(0,r.kt)("inlineCode",{parentName:"p"},"false")," by default."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"privateFunction: true")," can restrict access to this function to the contract itself."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"payableFunction: true")," will allow the function to accept payments (deposit). Without this flag, it will panic if any deposit was provided."),(0,r.kt)("h3",{id:"collections"},"Collections"),(0,r.kt)("p",null,"A few useful on-chain persistent collections are provided. All keys, values and elements are of type ",(0,r.kt)("inlineCode",{parentName:"p"},"string"),"."),(0,r.kt)("h4",{id:"vector"},"Vector"),(0,r.kt)("p",null,"Vector is an iterable implementation of vector that stores its content on the trie. Usage:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import {Vector} from 'near-sdk-js'\n\n// in contract class constructor:\nconstructor() {\n    super()\n    this.v = new Vector('my_prefix_')\n}\n\n// Override the deserializer to load vector from chain\ndeserialize() {\n    super.deserialize()\n    this.v = Object.assign(new Vector, this.v)\n}\n\nsomeMethod() {\n    // insert\n    this.v.push('abc')\n    this.v.push('def')\n    this.v.push('ghi')\n\n    // batch insert, extend:\n    this.v.extend(['xyz', '123'])\n\n    // get\n    let first = this.v.get(0)\n\n    // remove, move the last element to the given index\n    this.v.swapRemove(0)\n\n    // replace\n    this.v.replace(1, 'jkl')\n\n    // remove the last\n    this.v.pop()\n\n    // len, isEmpty\n    let len = this.v.length\n    let isEmpty = this.v.isEmpty()\n\n    // iterate\n    for (let element of this.v) {\n        near.log(element)\n    }\n\n    // toArray, convert to JavaScript Array\n    let a = this.v.toArray()\n\n    // clear\n    ths.v.clear()\n}\n")),(0,r.kt)("h4",{id:"lookupmap"},"LookupMap"),(0,r.kt)("p",null,"LookupMap is an non-iterable implementation of a map that stores its content directly on the trie. It's like a big hash map, but on trie. Usage:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import {LookupMap} from 'near-sdk-js'\n\n// in contract class constructor:\nconstructor() {\n    super()\n    this.m = new LookupMap('prefix_a')\n}\n\n// Override the deserializer to load vector from chain\ndeserialize() {\n    super.deserialize()\n    this.m = Object.assign(new LookupMap, this.m)\n}\n\nsomeMethod() {\n    // insert\n    this.m.set('abc', 'aaa')\n    this.m.set('def', 'bbb')\n    this.m.set('ghi', 'ccc')\n\n    // batch insert, extend:\n    this.m.extend([['xyz', '123'], ['key2', 'value2']])\n\n    // check exist\n    let exist = this.m.containsKey('abc')\n\n    // get\n    let value = this.m.get('abc')\n\n    // remove\n    this.m.remove('def')\n\n    // replace\n    this.m.set('ghi', 'ddd')\n}\n")),(0,r.kt)("h4",{id:"lookupset"},"LookupSet"),(0,r.kt)("p",null,"LookupSet is an non-iterable implementation of a set that stores its content directly on the trie. It's like LookupMap, but it only stores whether the value presents. Usage:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import {LookupSet} from 'near-sdk-js'\n\n// in contract class constructor:\nconstructor() {\n    super()\n    this.s = new LookupSet('prefix_b')\n}\n\n// Override the deserializer to load vector from chain\ndeserialize() {\n    super.deserialize()\n    this.s = Object.assign(new LookupSet, this.s)\n}\n\nsomeMethod() {\n    // insert\n    this.s.set('abc')\n    this.s.set('def')\n    this.s.set('ghi')\n\n    // batch insert, extend:\n    this.s.extend(['xyz', '123'])\n\n    // check exist\n    let exist = this.s.contains('abc')\n\n    // remove\n    this.s.remove('def')\n}\n")),(0,r.kt)("h4",{id:"unorderedmap"},"UnorderedMap"),(0,r.kt)("p",null,"UnorderedMap is an iterable implementation of a map that stores its content directly on the trie. Usage:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import {UnorderedMap} from 'near-sdk-js'\n\n// in contract class constructor:\nconstructor() {\n    super()\n    this.m = new UnorderedMap('prefix_c')\n}\n\n// Override the deserializer to load vector from chain\ndeserialize() {\n    super.deserialize()\n    this.m.keys = Object.assign(new Vector, this.m.keys)\n    this.m.values = Object.assign(new Vector, this.m.values)\n    this.m = Object.assign(new UnorderedMap, this.m)\n}\n\nsomeMethod() {\n    // insert\n    this.m.set('abc', 'aaa')\n    this.m.set('def', 'bbb')\n    this.m.set('ghi', 'ccc')\n\n    // batch insert, extend:\n    this.m.extend([['xyz', '123'], ['key2', 'value2']])\n\n    // get\n    let value = this.m.get('abc')\n\n    // remove\n    this.m.remove('def')\n\n    // replace\n    this.m.set('ghi', 'ddd')\n\n    // len, isEmpty\n    let len = this.m.length\n    let isEmpty = this.m.isEmpty()\n\n    // iterate\n    for (let [k, v] of this.m) {\n        near.log(k+v)\n    }\n\n    // toArray, convert to JavaScript Array\n    let a = this.m.toArray()\n\n    // clear\n    this.m.clear()\n}\n")),(0,r.kt)("h4",{id:"unorderedset"},"UnorderedSet"),(0,r.kt)("p",null,"UnorderedSet is an iterable implementation of a set that stores its content directly on the trie. It's like UnorderedMap but it only stores whether the value presents. Usage:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import {UnorderedSet} from 'near-sdk-js'\n\n// in contract class constructor:\nconstructor() {\n    super()\n    this.s = new UnorderedSet('prefix_d')\n}\n\n// Override the deserializer to load vector from chain\ndeserialize() {\n    super.deserialize()\n    this.s.elements = Object.assign(new Vector, this.s.elements)\n    this.s = Object.assign(new UnorderedSet, this.s)\n}\n\nsomeMethod() {\n    // insert\n    this.s.set('abc')\n    this.s.set('def')\n    this.s.set('ghi')\n\n    // batch insert, extend:\n    this.s.extend(['xyz', '123'])\n\n    // check exist\n    let exist = this.s.contains('abc')\n\n    // remove\n    this.s.remove('def')\n\n    // len, isEmpty\n    let len = this.s.length\n    let isEmpty = this.s.isEmpty()\n\n    // iterate\n    for (let e of this.s) {\n        near.log(e)\n    }\n\n    // toArray, convert to JavaScript Array\n    let a = this.s.toArray()\n\n    // clear\n    this.s.clear()\n}\n")),(0,r.kt)("h3",{id:"highlevel-promise-apis"},"Highlevel Promise APIs"),(0,r.kt)("p",null,"Within a contract class that decorated by ",(0,r.kt)("inlineCode",{parentName:"p"},"@Nearbindgen"),", you can work a high level JavaScript class, called ",(0,r.kt)("inlineCode",{parentName:"p"},"NearPromise"),". It's equivalently expressive as promise batch APIs but much shorter to write and can be chained like a JavaScript Promise."),(0,r.kt)("p",null,"In a ",(0,r.kt)("inlineCode",{parentName:"p"},"@call")," method, you can return either a JavaScript value or a ",(0,r.kt)("inlineCode",{parentName:"p"},"NearPromise")," object. In the later case, ",(0,r.kt)("inlineCode",{parentName:"p"},"@NearBindgen")," will automatically ",(0,r.kt)("inlineCode",{parentName:"p"},"promiseReturn")," it for you."),(0,r.kt)("p",null,"Usage:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// create new promise\nimport { NearPromise, near, includeBytes } from "near-sdk-js";\nimport { PublicKey } from "near-sdk-js/lib/types";\n\nlet promise = NearPromise.new("account-to-run-promise");\n\n// possible promise actions, choose and chain what you need:\npromise\n  .createAccount()\n  .transfer(1_000_000_000_000_000_000_000_000_000_000_000_000n)\n  .addFullAccessKey(new PublicKey(near.signerAccountPk()))\n  .addAccessKey(\n    new PublicKey(near.signerAccountPk()),\n    250000000000000000000000n, // allowance\n    "receiver_account_id",\n    "allowed_function_names"\n  )\n  .stake(100000000000000000000000000000n, new PublicKey(near.signerAccountPk()))\n  .deployContract(includeBytes("path/to/contract.wasm"))\n  .functionCall(\n    "callee_contract_account_id",\n    inputArgs,\n    0, // amount\n    2 * Math.pow(10, 13) // gas\n  )\n  .functionCallWeight(\n    "callee_contract_account_id",\n    inputArgs,\n    0, // amount\n    2 * Math.pow(10, 13), // gas\n    1 // weight\n  )\n  .deleteKey(new PublicKey(near.signerAccountPk()))\n  .deleteAccount("beneficial_account_id");\n\nreturn promise;\n')),(0,r.kt)("p",null,"In the case of deploy contract, ",(0,r.kt)("inlineCode",{parentName:"p"},"includeBytes")," is a helpful build-time util. You can include the content of a wasm contract, by using ",(0,r.kt)("inlineCode",{parentName:"p"},"includeBytes('path/to/contract.wasm')"),"."),(0,r.kt)("p",null,"In the case of ",(0,r.kt)("inlineCode",{parentName:"p"},"addFullAccessKey"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"addAccessKey")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"stake"),", it takes a ",(0,r.kt)("inlineCode",{parentName:"p"},"PublicKey")," object, you can find more details about it in the Types sections below."),(0,r.kt)("p",null,"Besides above APIs to build something on top of an API, you can also chain promises with ",(0,r.kt)("inlineCode",{parentName:"p"},".then")," and ",(0,r.kt)("inlineCode",{parentName:"p"},".and"),", they're equivalent to promiseThen, promiseAnd:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// assume promise, promise2 and promise3 are create with above APIs, with several actions added like above.\npromise.and(promise2).then(promise3); // promiseAnd of [promise_id, promise2_id], then promiseThen(promise_and_id, promise3_id)\n\nreturn promise;\n")),(0,r.kt)("h3",{id:"types"},"Types"),(0,r.kt)("p",null,"NEAR-SDK-JS also includes type defintions that are equivalent to that in Rust SDK / nearcore. You can browse them in near-sdk-js/src/types. Most of them are just type alias to string and bigint."),(0,r.kt)("h4",{id:"public-key"},"Public Key"),(0,r.kt)("p",null,"Public Key is representing a NEAR account's public key in a JavaScript class. You can either initiate a Public Key from binary data, or from a human readable string."),(0,r.kt)("p",null,"The binary data is in the same format as nearcore in ",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8Array"),". That's one byte to represent the curve type of the public key, either ed25519 (",(0,r.kt)("inlineCode",{parentName:"p"},"0x0"),"), or secp256k1 (",(0,r.kt)("inlineCode",{parentName:"p"},"0x1"),"), follows by the curve-specific public key data in bytes. Examples:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"new PublicKey(near.signerAccountPk());\nlet pk = new PublicKey(\n  new Uint8Array([\n    // CurveType.ED25519 = 0\n    0,\n    // ED25519 PublicKey data\n    186, 44, 216, 49, 157, 48, 151, 47, 23, 244, 137, 69, 78, 150, 54, 42, 30, 248,\n    110, 26, 205, 18, 137, 154, 10, 208, 26, 183, 65, 166, 223, 18,\n  ])\n);\nlet pk = new PublicKey(\n  new Uint8Array([\n    // CurveType.SECP256K1 = 1\n    1,\n    // SECP256K1 PublicKey data\n    242, 86, 198, 230, 200, 11, 33, 63, 42, 160, 176, 23, 68, 35, 93, 81, 92, 89,\n    68, 53, 190, 101, 27, 21, 136, 58, 16, 221, 71, 47, 166, 70, 206, 98, 234, 243,\n    103, 13, 197, 203, 145, 0, 160, 202, 42, 85, 178, 193, 71, 193, 233, 163, 140,\n    228, 40, 135, 142, 125, 70, 225, 251, 113, 74, 153,\n  ])\n);\n")),(0,r.kt)("p",null,"The human readable form is ",(0,r.kt)("inlineCode",{parentName:"p"},"ed25519:")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"secp256k1:")," following base58-encoded public key. And initialize the Public Key with ",(0,r.kt)("inlineCode",{parentName:"p"},"PublicKey.fromString"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"PublicKey.fromString('ed25519:DXkVZkHd7WUUejCK7i74uAoZWy1w9AZqshhTHxhmqHuB`)\nPublicKey.fromString('secp256k1:5r22SrjrDvgY3wdQsnjgxkeAbU1VcM71FYvALEQWihjM3Xk4Be1CpETTqFccChQr4iJwDroSDVmgaWZv2AcXvYeL`)\n")),(0,r.kt)("p",null,"Once a PublicKey object is created, it can be used in high level promise APIs that takes a public key, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"addFullAccessKey"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"addAccessKey")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"stake"),"."),(0,r.kt)("h2",{id:"how-to-use-near-sdk-js-on-windows"},"How to use NEAR SDK JS on Windows"),(0,r.kt)("p",null,"You can develop smart contracts on Windows using Windows Subsystem for Linux (WSL2).\nIn order to use WSL2, follow the next steps:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Run ",(0,r.kt)("inlineCode",{parentName:"li"},"PowerShell")," as Administrator"),(0,r.kt)("li",{parentName:"ul"},"Execute ",(0,r.kt)("inlineCode",{parentName:"li"},"wsl --install")," to install Ubuntu and do additional setup automatically. Check more details ",(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/windows/wsl/install"},"here")),(0,r.kt)("li",{parentName:"ul"},"Restart your machine"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"WSL2")," will continue setup process on start. Setup your username and password when prompted."),(0,r.kt)("li",{parentName:"ul"},"Check ",(0,r.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/windows/dev-environment/javascript/nodejs-on-wsl"},"this")," guide to setup ",(0,r.kt)("inlineCode",{parentName:"li"},"npm"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"node"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"npx"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"VSCode")," and other tools of your choice in order to start developing.")),(0,r.kt)("p",null,"In case of any issues of setting up WSL2 make sure that:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Your Windows OS is up to date"),(0,r.kt)("li",{parentName:"ul"},"Virtualisation is turned on in BIOS"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Windows Subsystem for Linux")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"Virtual Machine Platform")," are turned on in ",(0,r.kt)("inlineCode",{parentName:"li"},"Windows Features")," (Start -> Search -> Turn Windows Feature On or Off)")))}m.isMDXComponent=!0}}]);